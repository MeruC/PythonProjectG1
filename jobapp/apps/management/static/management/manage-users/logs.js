
$(document).ready(function() {
  const companiesTable = $('#activityLogsTable').DataTable({
      dom: 'Bfrtip',
      "autoWidth": false,
      "columnDefs": [
        // { "width": "33%", "targets": 0 },
        { "width": "65%", "targets": 0 },
        { "width": "35%", "targets": 1 },
     
      ],
      order: [[1, 'desc']],
      buttons: [
        {
            extend: 'pdf',
            download: 'open',
          //   exportOptions: {
          //     // starting index is 0
          //     columns: [  1,2,3 ],
          //   },
           
            title: `${nameOfUser} Activity Logs`,
            customize: function (doc) {
              // change table header background color
              doc.content[1].table.headerRows = 1;
              doc.content[1].table.widths = Array(doc.content[1].table.body[0].length).fill('auto');
              doc.content[1].table.body[0].forEach(function (column, index) {
                  column.fillColor = '#386641';
              });

              const rowCount = doc.content[1].table.body.length - 1; 
              doc.content.push({ text: `Total: ${rowCount}`, alignment: 'left', margin: [5, 10] });

              //set specific widths for the columns
              doc.content[1].table.widths = ['*', '15%'];
          
          
              // align table header to left
              const header = doc.content[1].table.body[0];
              header.forEach(cell => {
                  cell.alignment = 'left';
              });

              // add margin to each cell
              const tableBody = doc.content[1].table.body;
              tableBody.forEach(row => {
                  row.forEach(cell => {
                      cell.margin = [5, 5, 5, 5]; 
                  });
              });
            
              // footer
              doc.footer = function (page, pages) {
                  return {
                      text: [
                          { text: `Generated by: ${generatedBy}\n`, alignment: 'left' },
                          {
                              text: 'Date Generated: ' + new Date().toLocaleString('en-US', {
                                  month: 'long',
                                  day: '2-digit',
                                  year: 'numeric',
                                  hour: 'numeric',
                                  minute: 'numeric',
                                  hour12: true
                              }), alignment: 'left'
                          },{ text: `\n${page}`, alignment: 'right' },
                      ],
                      margin: [40, 0],
                      fontSize: 10
                  };
              };
          }
          
        },
        // {
        //     extend: 'print',
        //     exportOptions: {
        //       columns: [ 1,2,3,4 ,5 ]
        //     }
        // }
    ]
  });

  $('#activityLogsSearchField').keyup(function(){
      companiesTable.search($(this).val()).draw();
  });

});
function activityLogsReport() {
$('#activityLogsTable').DataTable().button('.buttons-html5').trigger();
}
